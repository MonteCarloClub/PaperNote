# 《属性密码学研究》阅读笔记

## 0. TODOs

1. 身份基密钥的构造，双线性对是什么？
2. 关于安全参数，尚未解释清楚。[Security parameter](https://en.wikipedia.org/wiki/Security_parameter)
3. 属性加密的选择安全模型尚未解释清楚。

## 1. 属性密码学 > 公钥密码学 + 身份基密码学

属性密码学是公钥（非对称密钥）密码学和基于身份的密码学的拓展。

> 简单地，基于身份的密码学解决了传统公钥跟用户身份不相关的问题，它把用户的某种身份当成对应的公钥。例如，发送者向接收者发送了一条经过接收者电子邮箱加密（可读的公钥）的消息，这条消息有且仅有拥有私钥的用户，即接收者可以解密和阅读。另外，拥有某个公钥的用户可以验证对应用户的数字签名。
>
> 身份基密钥的构造是一个难点，涉及双线性对。TODO

属性加密机制可以基于内容，也可以基于消息接收者的特征。这带来了诸多好处，属性加密不需要加密者指定特定的解密者，满足密文策略的用户即可解密，这意味着属性加密机制是一对多的。另外，加密策略由加密者完全控制，支持多种逻辑表达式。

## 2. 交互式访问控制 v.s. 非交互式访问控制

**暂时不考虑属性密码学跟区块链的联系，从C/S架构的视角观察属性密码学。**

在传统模式下，客户端把数据存储到服务器；其他客户端从服务器访问数据会跟服务器进行一对一交互，服务器需要确定访问者的权限。传统模式会带来显著的问题，例如服务器被攻破会导致毁灭性后果，不能抵御DOS攻击等。

在基于属性密码学的数据访问机制下，数据提供者把访问权限映射成一系列属性的逻辑表达式。服务器只做二件事，一是验证每个属性并颁发对应的密钥，二是存储加密后的数据。这样，访问者的权限控制不是由服务器交互地完成，而是由加密数据的提供者事先完成。这也实现了细粒度的权限控制。

> 根据我的理解，基于属性密码学的数据访问机制实现了权限分离，即数据访问的策略制定由对应的数据提供者完成。

## 3. 公私钥对生成 & 加解密

非对称加密的关键步骤是生成公私钥对。

### 3.1. 安全参数 + 属性 -> 公钥 + 主私钥

一般地，我用*ku*表示公钥（public key），用*kr*表示私钥（private key）。

<img src="https://render.githubusercontent.com/render/math?math=ku%2c+mkr+%3d+Setup(k%2c+U)">

*mkr*表示主私钥，*k*是安全参数，*U*是属性描述。

> 主私钥是用来验证工作密钥是否合法的密钥。
>
> 安全参数是任意选择的，用来度量破解算法（解决一个难问题）需要的输入实例规模。我们只需要提供一个较大的安全参数即可。请参考维基百科词条[Security parameter](https://en.wikipedia.org/wiki/Security_parameter)。TODO
>
> 属性描述，属性跟权限对应。这个属性可以基于内容，也可以基于接收者的身份。

### 3.2. 主私钥 + 权限 -> 私钥

我们已经获得了公钥*ku*和主私钥*mkr*，这一步我们需要把属性跟权限对应起来。

<img src="https://render.githubusercontent.com/render/math?math=kr+%3d+Keygen(mkr%2c+X)">

*X*表示跟属性*U*对应的权限。

### 3.3. 公钥 + 密文索引 + 明文 -> 密文

我们已经获得了公钥和私钥，下面对明文进行加密。

<img src="https://render.githubusercontent.com/render/math?math=CT_Y+%3d+Enc(ku%2c+Y%2c+m)">

*CT_Y*代表密文，*Y*代表密文索引，*m*是明文，即被加密的消息。

> 密文索引源自数据库加密技术。传统数据库索引是明文索引，加密列不能使用索引；密文索引以加密后的数据为检索条件，性能稍差于明文索引。

### 3.4. 公钥 + 私钥 + 密文 -> 明文

这是解密的过程，我们代入3.1—3.3的表达式（假如解密结果正确）：

<img src="https://render.githubusercontent.com/render/math?math=m+%3d+Dec(ku%2c+kr%2c+CT_Y)+%3d+Dec(ku%2c+Keygen(mkr%2c+X)%2c+Enc(ku%2c+Y%2c+m))">

如果正确地获得了*ku*和*mkr*，那么对任意用户的*X*和*Y*，解密结果均正确。

## 4. 密钥策略、密文策略、访问结构和属性集合

属性加密分成二种策略，密文策略的属性加密（CP-ABE）和密钥策略的属性加密（KP-ABE）。

在对属性加密进行分类前，我们需要了解什么是访问结构和属性集合。

### 4.1. 访问结构

访问结构的数据结构是树。它的叶节点对应了加密方设置的属性和属性值以及存储的密文；非叶节点是门限节点，门限节点控制了访问者对密文的访问。

门限节点可以记成*m/n*，*m*代表这个门限节点要求访问者至少需要满足的子节点数目，*n*代表这个门限节点的子节点数目。门限节点以树状拓扑结构组合，可以实现复杂的权限控制。

关于访问树，建议参考[密文策略基于属性加密(CP-ABE)访问树构造与解密](https://blog.csdn.net/ping802363/article/details/65639016)。

### 4.2. 密钥策略 v.s. 密文策略


| **属性加密类别** | **权限*X*跟密文索引*Y*的关系** | **应用场景和特点** |
| - | - | - |
| 密文策略的属性加密（CP-ABE） | *X*是属性集合，*Y*是访问结构；*X*满足*Y***等价于***X*是*Y*的授权集 | 加密存储，随时可解密，云环境、智慧城市等 |
| 密钥策略的属性加密（KP-ABE） | *X*是访问结构，*Y*是属性集合；*X*满足*Y***等价于***Y*是*X*的授权集 | 细粒度共享数据加密，共享日志、广播加密等 |

## 5. 属性加密的安全性

任意多项式敌手的优势趋于0**等价于**属性加密方案是自适应安全的。

如果敌手*A*会提前选择和公布自己的攻击目标，那么属性加密方案是选择安全的。

设敌手是*A*，挑战者是*S*。敌手的优势定义成：

<img src="https://render.githubusercontent.com/render/math?math=Adv_A(k)+%3d+%7c+Pr(b%27+%3d+b)+-+%5cfrac%7b1%7d%7b2%7d+%7c">

属性加密的选择安全模型如下：TODO

## 6. 从加解密到签名和验签

签名和验签的过程跟加密和解密相似。

安全参数 + 属性 -> 公钥 + 主私钥

主私钥 + 权限 -> 私钥

**公钥 + 签名策略 + 私钥 + 被签名消息 -> 签名**

**公钥 + 签名 + 被签名消息 -> 是否验证通过**

## 7. 属性签名的安全性

属性签名的安全性包含二层含义：不可伪造性和匿名性。

针对属性签名方案的不可伪造性，敌手的目标是输出一个同样合法的签名。相似地，我们假设敌手会提前选择和公布自己的攻击目标，即签名策略。如果任意多项式敌手通过伪造签名策略获得合法签名的概率趋于0，那么我们称属性签名方案是自适应不可伪造的。

针对属性签名方案的匿名性，我们考虑对验签者，他根据验签结果仅能知道签名者属性是否满足签名策略，不能知道签名者的属性和其他身份信息。对满足签名策略的不同权限，通过它们产生的不同的合法签名，敌手不能知道签名跟权限之间的对应关系。
